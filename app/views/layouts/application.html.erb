

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  header a{

  }

  .ul-right-form{
    width:60px;
    height: 30px;
  background: transparent;
  margin:0;
  padding:0;
  padding-right:10px;
  }
  </style>

  <title>Diy</title>

  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= csrf_meta_tags %>
  <script>
  $(
      function(){
          $("a#nav-login").click(function(event){
              event.preventDefault();
              event.stopPropagation();
              $(".login-overlay").removeClass("no-display");
              $(".login-modal").removeClass("no-display");
          });

          $("a#nav-signup").click(function(event){
              event.preventDefault();
              event.stopPropagation();
              $(".signup-overlay").removeClass("no-display");
              $(".signup-modal").removeClass("no-display");
          });

          $(".create-new-post").click(function(event){
              event.preventDefault();
              event.stopPropagation();
              <% if !current_user %>
              alert("Please log in or sign up first!");

              <% else %>
                  if( !window.currentUser){
                      alert("This is a bug need to fix in application.html.erb!");
                      return;
                  }
                  Backbone.history.navigate("posts/new", { trigger: true });
              <% end %>

          });


      }

  );

  </script>
</head>
<body>
  <header class="header">
    <nav class="header group">
      <ul class="header-ul-left group">
        <li><a class="create-new-post" href="/#/posts/new">Create Post</a></li>

        <li><a href="/#/posts">Posts</a></li>
    <li><a href="/">Home</a></li>
      </ul>

      <% if current_user %>

        <ul class="header-ul-right group">
          <li><a href="<%= user_url(current_user) %>">You</a></li>
          <li>
            <form class="ul-right-form" action="<%= session_url %>" method="post">
              <input type="hidden" name="authenticity_token"
                     value="<%= form_authenticity_token %>" />
              <input type="hidden" name="_method" value="delete">
              <input class="form-input" type="submit" value="Log Out" id="signout-button">
            </form>
          </li>
        </ul>

      <% else %>

          <ul class="header-ul-right group">

            <li><a id="nav-login">Log In</a></li>
            <li><a id="nav-signup">Sign Up</a></li>
          </ul>

      <% end  %>
    </nav>
  </header>

  <% if flash[:errors] %>
    <h2><%=  flash[:errors].join(", ").html_safe %></h2>
  <% elsif flash[:notice] %>
    <h2><%=  flash[:notice].html_safe %></h2>
  <% end %>
<%= yield %>

<div class='login-overlay no-display'>
</div>

<div class="login-modal no-display">
    <form class="login-form" action="<%= session_url %>" method="post" enctype="multipart/form-data">
      <input type="hidden" name="authenticity_token"
             value="<%= form_authenticity_token %>" >


      <label for="user_email">Email </label>
      <input class="space"
        type="email"
        name="user[email]"

        id="user_email">


      <label for="user_username">Username</label>
      <input class="space"
        type="text"
        name="user[username]"

        id="user_username">


      <label for="user_password">Password </label>
      <input class="space"
        type="password"
        name="user[password]"

        id="user_password">

    <input type="submit" value="Log In" id="login-button">
    <a  class="login-button" href="/auth/facebook">Facebook Log In</a>
    <a  class="login-button" href="<%= demo_session_url %>">Guest Log In</a>

    </form>
</div>

<div class='signup-overlay no-display'>
</div>

<div class="signup-modal no-display">
    <form class="login-form" action="<%= users_url %>" method="post" enctype="multipart/form-data">
      <input type="hidden" name="authenticity_token"
             value="<%= form_authenticity_token %>" >


      <label for="user_email">Email </label>
      <input class="space"
        type="email"
        name="user[email]"

        id="user_email">


      <label for="user_username">Username</label>
      <input class="space"
        type="text"
        name="user[username]"

        id="user_username">


      <label for="user_password">Password </label>
      <input class="space"
        type="password"
        name="user[password]"

        id="user_password">

    <label>
      Upload Picture

      <input type="file" name="user[photo]" >

    </label>

    <input type="submit" value="Sign Up" id="login-button">


    </form>
</div>


</body>
</html>